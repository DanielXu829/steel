<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="This is my page">
    <!--PageOffice.js和jquery.min.js文件一定要引用-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script type="text/javascript" src="http://10.0.75.1:9000/web-apps/apps/api/documents/api.js"></script>
</head>

<body>
<div style="text-align:center;">
    <b>在线编辑测试</b><br>
    <div th:each="demo,demoStat : ${list}">
        <a th:href="${demo.path2}" th:text="${demo.name}">在线Office测试</a><br>
    </div>
    <div id="placeholder"></div>
</div>
<script type="text/javascript" th:inline="javascript">
    var fileName = [[${fileName}]];
    var fileType = [[${fileType}]];
    var type = [[${type}]];
    var documentType = [[${documentType}]];
    var mode = [[${mode}]];

    function doAction(name, path) {
        new DocsAPI.DocEditor("placeholder", {
                "width": "100%",
                "height": "1000px",
                "type": "desktop",
                "documentType": "text",
                "token": "",
                "document": {
                    "fileType": "xlsx",
                    "key": "Khirz6zTPdfd2",
                    "title": name,
                    "url": path
                }, "editorConfig": {
                    "mode": "edit",
                    "lang": "en",
                    "callbackUrl": "http://10.0.75.1:8181/onlyoffice/demo",
                    "user": {
                        "id": "uid-1",
                        "name": "Jonn Smith"
                    }
                }
            }
        );
    }

    // $.ajax({
    //     url: "/onlyoffice/open", data: {}, success: function (data) {
    //         console.log(data);
    //         new DocsAPI.DocEditor("placeholder", {
    //             "document": {
    //                 "fileType": "xlsx",
    //                 "key": "Khirz6zTPdfd7",
    //                 "title": data.data[0].name,
    //                 "url": data.data[0].path2
    //             },
    //             "documentType": "text"
    //         });
    //     }
    // });

</script>
</body>
</html>